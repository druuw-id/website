"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[806],{26867:(t,e,r)=>{r.r(e),r.d(e,{_HDRTextureLoader:()=>a});var n=r(18002);class a{constructor(){this.supportCascades=!1}loadCubeData(){throw".hdr not supported in Cube."}loadData(t,e,r){const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o=(0,n.NK)(a),i=(0,n.LT)(a,o),h=o.width*o.height,c=new Float32Array(4*h);for(let t=0;t<h;t+=1)c[4*t]=i[3*t],c[4*t+1]=i[3*t+1],c[4*t+2]=i[3*t+2],c[4*t+3]=1;r(o.width,o.height,e.generateMipMaps,!1,(()=>{const t=e.getEngine();e.type=1,e.format=5,e._gammaSpace=!1,t._uploadDataToTextureDirectly(e,c)}))}}},18002:(t,e,r)=>{r.d(e,{I9:()=>s,LT:()=>c,NK:()=>i,VH:()=>h});var n=r(14875);function a(t,e,r,n,a,o){a>0?(a=function(t,e){return e>1023?1*Math.pow(2,1023)*Math.pow(2,e-1023):e<-1074?1*Math.pow(2,-1074)*Math.pow(2,e+1074):1*Math.pow(2,e)}(0,a-136),t[o+0]=e*a,t[o+1]=r*a,t[o+2]=n*a):(t[o+0]=0,t[o+1]=0,t[o+2]=0)}function o(t,e){let r="",n="";for(let a=e;a<t.length-e&&(n=String.fromCharCode(t[a]),"\n"!=n);a++)r+=n;return r}function i(t){let e=0,r=0,n=o(t,0);if("#"!=n[0]||"?"!=n[1])throw"Bad HDR Format.";let a=!1,i=!1,h=0;do{h+=n.length+1,n=o(t,h),"FORMAT=32-bit_rle_rgbe"==n?i=!0:0==n.length&&(a=!0)}while(!a);if(!i)throw"HDR Bad header format, unsupported FORMAT";h+=n.length+1,n=o(t,h);const c=/^-Y (.*) \+X (.*)$/g.exec(n);if(!c||c.length<3)throw"HDR Bad header format, no size";if(r=parseInt(c[2]),e=parseInt(c[1]),r<8||r>32767)throw"HDR Bad header format, unsupported size";return h+=n.length+1,{height:e,width:r,dataPosition:h}}function h(t,e,r=!1){const a=new Uint8Array(t),o=i(a),h=c(a,o);return n.D.ConvertPanoramaToCubemap(h,o.width,o.height,e,r)}function c(t,e){return function(t,e){let r=e.height;const n=e.width;let o,i,h,c,s,w=e.dataPosition,f=0,d=0,l=0;const C=new ArrayBuffer(4*n),p=new Uint8Array(C),b=new ArrayBuffer(e.width*e.height*4*3),g=new Float32Array(b);for(;r>0;){if(o=t[w++],i=t[w++],h=t[w++],c=t[w++],2!=o||2!=i||128&h||e.width<8||e.width>32767)return u(t,e);if((h<<8|c)!=n)throw"HDR Bad header format, wrong scan line width";for(f=0,l=0;l<4;l++)for(d=(l+1)*n;f<d;)if(o=t[w++],i=t[w++],o>128){if(s=o-128,0==s||s>d-f)throw"HDR Bad Format, bad scanline data (run)";for(;s-- >0;)p[f++]=i}else{if(s=o,0==s||s>d-f)throw"HDR Bad Format, bad scanline data (non-run)";if(p[f++]=i,--s>0)for(let e=0;e<s;e++)p[f++]=t[w++]}for(l=0;l<n;l++)o=p[l],i=p[l+n],h=p[l+2*n],c=p[l+3*n],a(g,o,i,h,c,(e.height-r)*n*3+3*l);r--}return g}(t,e)}function u(t,e){let r=e.height;const n=e.width;let o,i,h,c,u,s=e.dataPosition;const w=new ArrayBuffer(e.width*e.height*4*3),f=new Float32Array(w);for(;r>0;){for(u=0;u<e.width;u++)o=t[s++],i=t[s++],h=t[s++],c=t[s++],a(f,o,i,h,c,(e.height-r)*n*3+3*u);r--}return f}const s={RGBE_ReadHeader:i,GetCubeMapTextureData:h,RGBE_ReadPixels:c}},14875:(t,e,r)=>{r.d(e,{D:()=>a});var n=r(18159);class a{static ConvertPanoramaToCubemap(t,e,r,n,a=!1){if(!t)throw"ConvertPanoramaToCubemap: input cannot be null";if(t.length!=e*r*3)throw"ConvertPanoramaToCubemap: input size is wrong";return{front:this.CreateCubemapTexture(n,this.FACE_FRONT,t,e,r,a),back:this.CreateCubemapTexture(n,this.FACE_BACK,t,e,r,a),left:this.CreateCubemapTexture(n,this.FACE_LEFT,t,e,r,a),right:this.CreateCubemapTexture(n,this.FACE_RIGHT,t,e,r,a),up:this.CreateCubemapTexture(n,this.FACE_UP,t,e,r,a),down:this.CreateCubemapTexture(n,this.FACE_DOWN,t,e,r,a),size:n,type:1,format:4,gammaSpace:!1}}static CreateCubemapTexture(t,e,r,n,a,o=!1){const i=new ArrayBuffer(t*t*4*3),h=new Float32Array(i),c=o?Math.max(1,Math.round(n/4/t)):1,u=1/c,s=u*u,w=e[1].subtract(e[0]).scale(u/t),f=e[3].subtract(e[2]).scale(u/t),d=1/t;let l=0;for(let o=0;o<t;o++)for(let i=0;i<c;i++){let i=e[0],C=e[2];for(let e=0;e<t;e++)for(let u=0;u<c;u++){const c=C.subtract(i).scale(l).add(i);c.normalize();const u=this.CalcProjectionSpherical(c,r,n,a);h[o*t*3+3*e+0]+=u.r*s,h[o*t*3+3*e+1]+=u.g*s,h[o*t*3+3*e+2]+=u.b*s,i=i.add(w),C=C.add(f)}l+=d*u}return h}static CalcProjectionSpherical(t,e,r,n){let a=Math.atan2(t.z,t.x);const o=Math.acos(t.y);for(;a<-Math.PI;)a+=2*Math.PI;for(;a>Math.PI;)a-=2*Math.PI;let i=a/Math.PI;const h=o/Math.PI;i=.5*i+.5;let c=Math.round(i*r);c<0?c=0:c>=r&&(c=r-1);let u=Math.round(h*n);u<0?u=0:u>=n&&(u=n-1);const s=n-u-1;return{r:e[s*r*3+3*c+0],g:e[s*r*3+3*c+1],b:e[s*r*3+3*c+2]}}}a.FACE_LEFT=[new n.Vector3(-1,-1,-1),new n.Vector3(1,-1,-1),new n.Vector3(-1,1,-1),new n.Vector3(1,1,-1)],a.FACE_RIGHT=[new n.Vector3(1,-1,1),new n.Vector3(-1,-1,1),new n.Vector3(1,1,1),new n.Vector3(-1,1,1)],a.FACE_FRONT=[new n.Vector3(1,-1,-1),new n.Vector3(1,-1,1),new n.Vector3(1,1,-1),new n.Vector3(1,1,1)],a.FACE_BACK=[new n.Vector3(-1,-1,1),new n.Vector3(-1,-1,-1),new n.Vector3(-1,1,1),new n.Vector3(-1,1,-1)],a.FACE_DOWN=[new n.Vector3(1,1,-1),new n.Vector3(1,1,1),new n.Vector3(-1,1,-1),new n.Vector3(-1,1,1)],a.FACE_UP=[new n.Vector3(-1,-1,-1),new n.Vector3(-1,-1,1),new n.Vector3(1,-1,-1),new n.Vector3(1,-1,1)]},6740:(t,e,r)=>{r.d(e,{Uu:()=>i,Y5:()=>a,n9:()=>o});const n={};function a(t,e){n[t]=e}function o(t){return n[t]}function i(t){for(const e in n)if(t instanceof n[e]&&!e.includes("Abstract"))return e;return"Unknown"}}}]);